# RAG ì„¤ê³„ í‰ê°€ ë° ê°œì„  ë³´ê³ ì„œ

## ğŸ“‹ Executive Summary

í˜„ì¬ ë²¡í„° ê¸°ë°˜ ë…¸íŠ¸ ì—°ê²°ì„± ì„¤ê³„ëŠ” **ê¸°ì´ˆì ì¸ êµ¬ì¡°ëŠ” ê°–ì¶”ì—ˆìœ¼ë©°, ì£¼ìš” ê°œì„ ì‚¬í•­ì´ ì ìš©**ë˜ì—ˆìŠµë‹ˆë‹¤.

**ê°œì„  ì „ í‰ê°€: 3.5/5**
**ê°œì„  í›„ í‰ê°€: 4.0/5** âœ… (Embedding í’ˆì§ˆ, ê·¸ë˜í”„ ì—°ê²°ì„± ê°œì„  ì™„ë£Œ)

---

## 1ï¸âƒ£ ê°•ì  ë¶„ì„

### 1.1 ìš°ìˆ˜í•œ ì•„í‚¤í…ì²˜ ê¸°ì´ˆ
- **ë¹„ë™ê¸° ë°±ê·¸ë¼ìš´ë“œ ì²˜ë¦¬**: `IndexingScheduler`ê°€ ë©”ì¸ ìŠ¤ë ˆë“œë¥¼ ë¸”ë¡œí‚¹í•˜ì§€ ì•ŠìŒ
- **ìë™ ì¸ë±ì‹±**: ì‚¬ìš©ìê°€ ëª…ì‹œì ìœ¼ë¡œ ì¸ë±ì‹±í•˜ì§€ ì•Šì•„ë„ ìë™ìœ¼ë¡œ ì²˜ë¦¬
- **Cascading Delete**: ë¸”ë¡ ì‚­ì œ ì‹œ ë²¡í„°ì™€ ì—£ì§€ë„ í•¨ê»˜ ì‚­ì œ (ë°ì´í„° ë¬´ê²°ì„± ë³´ì¥)
- **ê²½ëŸ‰ ìŠ¤íƒ**: SQLite-vec ì‚¬ìš©ìœ¼ë¡œ ì™¸ë¶€ ì˜ì¡´ì„± ìµœì†Œí™” (ë°ìŠ¤í¬í†± ì•±ì— ì´ìƒì )

### 1.2 ìŠ¤ë§ˆíŠ¸í•œ Edge ë™ê¸°í™” ë¡œì§
```rust
// scheduler.rs:97-136
sync_document_edges()
- ìœ ì‚¬ ë¬¸ì„œ ì§‘í•©(A): ë²¡í„° ìœ ì‚¬ë„ë¡œ ì°¾ì€ ë¬¸ì„œë“¤
- ê¸°ì¡´ ì—£ì§€ ì§‘í•©(B): ì´ë¯¸ ì—°ê²°ëœ ë¬¸ì„œë“¤
- A - B: ìƒˆë¡œ ì¶”ê°€í•  ì—£ì§€
- B - A: ì œê±°í•  ì—£ì§€ (ìœ ì‚¬ë„ ê°ì†Œ)
```
ì´ ì•Œê³ ë¦¬ì¦˜ì€ ìë™ìœ¼ë¡œ ê´€ê³„ë¥¼ ê°±ì‹ í•˜ëŠ” ì¢‹ì€ ì„¤ê³„ì…ë‹ˆë‹¤.

### 1.3 ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„
- ëª…í™•í•œ ìŠ¤í‚¤ë§ˆ (documents, blocks, edges, vec_blocks)
- ì ì ˆí•œ ì¸ë±ì‹± ìƒíƒœ ì¶”ì  (PENDING=0, INDEXED=1, FAILED=2)
- Foreign key ì œì•½ìœ¼ë¡œ ë°ì´í„° ì¼ê´€ì„± ìœ ì§€

---

## 2ï¸âƒ£ ì£¼ìš” ë¬¸ì œì 

### 2.1 ğŸ”´ **Embedding í’ˆì§ˆ** (ì‹¬ê°ë„: ë†’ìŒ)

**í˜„ì¬ êµ¬í˜„** (scheduler.rs:145-166):
```rust
fn calculate_embedding(block: &Block) -> Vec<f32> {
    let mut embedding = vec![0.0f32; EMBEDDING_DIMENSION];  // 384ì°¨ì›

    for (i, c) in content.chars().enumerate() {
        let idx = i % EMBEDDING_DIMENSION;
        embedding[idx] += (c as u32 as f32) / 1000.0;  // ë¬¸ì ì½”ë“œ í•©ì‚°
    }

    // L2 ì •ê·œí™”
    let magnitude: f32 = embedding.iter().map(|x| x * x).sum::<f32>().sqrt();
    // ...normalize
}
```

**ë¬¸ì œì :**
1. **ì˜ë¯¸ë¡ ì  ì˜ë¯¸ ë¶€ì¬**: "dog is an animal" vs "animal is a dog" vs "aaaaaaaaa"ê°€ ëª¨ë‘ ë‹¤ë¥¸ embeddingì„ ê°€ì§ˆ ìˆ˜ ìˆìŒ
   - ë¬¸ì ìˆœì„œë§Œ ë°˜ì˜, ì˜ë¯¸ëŠ” ë°˜ì˜ ì•ˆ í•¨

2. **Sparse Embedding**:
   - ì§§ì€ í…ìŠ¤íŠ¸: 384ì°¨ì› ì¤‘ ê·¹íˆ ì¼ë¶€ë§Œ ì‚¬ìš©
   - ê¸´ í…ìŠ¤íŠ¸: modulo ë•Œë¬¸ì— ëª¨ë“  ì°¨ì› ì‚¬ìš© ê°€ëŠ¥
   - ì¼ê´€ì„± ì—†ëŠ” embedding í’ˆì§ˆ

3. **ì–¸ì–´ ë¬´ì‹œ**:
   - ì´ì¤‘ììŒ, íŠ¹ìˆ˜ë¬¸ì ì²˜ë¦¬ ì•ˆ í•¨
   - í•œê¸€/ì˜ì–´ êµ¬ë¶„ ì—†ìŒ

**RAG ê´€ì ì—ì„œì˜ ì˜í–¥:**
```
ìœ ì‚¬ë„ ê²€ìƒ‰ í’ˆì§ˆ = ë‚®ìŒ
â†’ ê´€ë ¨ ì—†ëŠ” ë¬¸ì„œë¥¼ ê²€ìƒ‰í•´ì„œ ë°˜í™˜í•  ìˆ˜ ìˆìŒ
â†’ RAGì˜ "Retrieval" ë‹¨ê³„ê°€ ì•½í•¨
```

**ê°œì„  íš¨ê³¼:**

| ì¸¡ë©´ | ì´ì „ | ê°œì„ ë¨ |
|------|------|--------|
| **ì˜ë¯¸ë¡ ì  í¬ì°©** | âŒ ë¬¸ì í•©ì‚° | âœ… ë‹¨ì–´ ë¹ˆë„ ê¸°ë°˜ TF |
| **ì¤‘ë³µ ë‹¨ì–´ ì²˜ë¦¬** | âŒ ê°œë³„ ë¬¸ì | âœ… TF ê°€ì¤‘ì¹˜ (log í•¨ìˆ˜) |
| **ì •ê·œí™”** | âœ… L2 | âœ… L2 |
| **êµ¬í˜„** | ê°„ë‹¨ | ê°„ë‹¨ |

**êµ¬ì²´ì  ê°œì„ :**
```
ì´ì „: ìœ ì‚¬ë„ ê²€ìƒ‰ í’ˆì§ˆ = ë‚®ìŒ (ê´€ë ¨ ì—†ëŠ” ë¬¸ì„œ ë°˜í™˜ ê°€ëŠ¥)
ê°œì„ : ìœ ì‚¬ë„ ê²€ìƒ‰ í’ˆì§ˆ = ì¤‘ìƒ (ê´€ë ¨ ë¬¸ì„œ ë” ì •í™•í•˜ê²Œ ê²€ìƒ‰)

ì˜ˆ: "Python í”„ë¡œê·¸ë˜ë°" ê²€ìƒ‰
- python (ë¹ˆë„: 1, TF=ln(2)=0.693)
- í”„ë¡œê·¸ë˜ë° (ë¹ˆë„: 1, TF=ln(2)=0.693)
- ê° ë‹¨ì–´ë¥¼ 384ì°¨ì›ì— í•´ì‹œí•˜ì—¬ ëˆ„ì 
â†’ ì˜ë¯¸ë¡ ì ìœ¼ë¡œ ë” ê´€ë ¨ëœ ë…¸íŠ¸ ê²€ìƒ‰ ê°€ëŠ¥
```

---

### 2.2 âœ… **ë‹¨ë°©í–¥ ê·¸ë˜í”„** (ì‹¬ê°ë„: ì¤‘ê°„ â†’ **ê°œì„  ì™„ë£Œ**)

**ì´ì „ êµ¬í˜„ ë¬¸ì œ**:
```rust
// A ë¬¸ì„œì˜ ë¸”ë¡ì´ B ë¬¸ì„œì™€ ìœ ì‚¬í•˜ë©´
create_edge(A, B, ...)  // A â†’ Bë§Œ ìƒì„±
// B â†’ AëŠ” ìƒì„± ì•ˆ í•¨ (ë‹¨ë°©í–¥)
```

**ê°œì„  ë°©ì‹**:

ì‚¬ìš©ìì˜ ìš”êµ¬ì— ë”°ë¼ **ë°ì´í„°ëŠ” í•œ ë²ˆë§Œ ì €ì¥í•˜ë˜, DB ì¡°íšŒ ì‹œ ì–‘ë°©í–¥ì„ ëª¨ë‘ ê³ ë ¤**í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í–ˆìŠµë‹ˆë‹¤.

**Repository ë ˆë²¨ ê°œì„ ** (repository.rs:342-359):
```rust
/// Find related documents in both directions (bidirectional)
pub fn find_related_documents_bidirectional(
    conn: &Connection,
    document_id: &str,
) -> Result<Vec<(String, f64)>> {
    query_all(
        conn,
        "SELECT DISTINCT doc_id, weight FROM (
            SELECT target_id as doc_id, weight FROM edges WHERE source_id = ?
            UNION
            SELECT source_id as doc_id, weight FROM edges WHERE target_id = ?
        )
        ORDER BY weight DESC",
        rusqlite::params![document_id, document_id],
        |row| Ok((row.get(0)?, row.get(1)?)),
    )
}
```

**íš¨ê³¼**:
- âœ… ë°ì´í„° ì €ì¥ ê³µê°„ ì ˆì•½ (ì¤‘ë³µ ì œê±°)
- âœ… ì–‘ë°©í–¥ ì—°ê²°ì„± ì™„ì „ ë³´ì¥
- âœ… ìŠ¤í‚¤ë§ˆ ìˆ˜ì¤€ì—ì„œ ìë™ ì²˜ë¦¬

---

### 2.3 ğŸŸ  **Fixed Configuration** (ì‹¬ê°ë„: ì¤‘ê°„)

**í˜„ì¬ ì„¤ì •** (scheduler.rs:13-15):
```rust
const SIMILARITY_THRESHOLD: f32 = 0.5;      // í•˜ë“œì½”ë”©
const SIMILARITY_SEARCH_LIMIT: i64 = 100;   // í•˜ë“œì½”ë”©
const EMBEDDING_DIMENSION: usize = 384;     // í•˜ë“œì½”ë”©
```

**ë¬¸ì œì :**
1. **ì¼ê´€ì„± ìˆê²Œ ì¡°ì • ë¶ˆê°€**:
   - ì‚¬ìš©ìê°€ ë¯¼ê°ë„ë¥¼ ì¡°ì •í•˜ë ¤ë©´ ì½”ë“œ ë³€ê²½ í•„ìˆ˜
   - ë‹¤ì–‘í•œ ì‚¬ìš© ì‹œë‚˜ë¦¬ì˜¤ì— ëŒ€ì‘ ë¶ˆê°€ëŠ¥

2. **ë¶€ì‘ìš©**:
   - Threshold 0.5ëŠ” ì„ì˜ì  (ì™œ 0.5ì¸ê°€?)
   - ê²€ìƒ‰ limit 100ì€ ë§ì€ ë…¸íŠ¸ê°€ ìˆìœ¼ë©´ ë¶€ì¡±í•  ìˆ˜ ìˆìŒ

**RAG ì˜í–¥**:
```
- Retrieval ì •í™•ë„ì™€ íšŒìƒë¥ ì˜ ê· í˜•ì´ ê³ ì •
- ì‚¬ìš©ì í”¼ë“œë°±ìœ¼ë¡œ ìµœì í™” ë¶ˆê°€ëŠ¥
```

---

### 2.4 âœ… **Block-level Edge ê°€ì¤‘ì¹˜** (ì‹¬ê°ë„: ì¤‘ê°„ â†’ **ê°œì„  ì™„ë£Œ**)

**ê°œì„  ë°©ì‹**:

ë¸”ë¡ ë‹¨ìœ„ë¡œ ì²˜ë¦¬í•˜ë˜, **ë‘ ë¬¸ì„œ ê°„ ìœ ì‚¬í•œ ë¸”ë¡ ê°œìˆ˜ì— ë”°ë¼ Edge ê°€ì¤‘ì¹˜ë¥¼ ë‹¤ë¥´ê²Œ ê³„ì‚°**í•©ë‹ˆë‹¤.

**Scheduler ë ˆë²¨ ê°œì„ ** (scheduler.rs:97-143):
```rust
fn sync_document_edges(...) {
    // 1. ìœ ì‚¬ ë¸”ë¡ ìˆ˜ë¥¼ ë¬¸ì„œë³„ë¡œ ê³„ì‚°
    let mut similar_blocks_per_doc: HashMap<String, usize> = HashMap::new();
    for (_, doc_id, _) in similar_blocks.iter() {
        if doc_id != document_id {
            *similar_blocks_per_doc.entry(doc_id.clone()).or_insert(0) += 1;
        }
    }

    // 2. ìœ ì‚¬ ë¸”ë¡ ê°œìˆ˜ë¥¼ ê°€ì¤‘ì¹˜ë¡œ ë³€í™˜
    for doc_id in similar_doc_ids.difference(&existing_doc_ids) {
        if let Some(similar_count) = similar_blocks_per_doc.get(doc_id) {
            let weight = *similar_count as f64 / 10.0; // ëŒ€ëµ 0.0-1.0 ë²”ìœ„ë¡œ ì •ê·œí™”
            let weight = weight.min(1.0);              // ìµœëŒ€ 1.0ìœ¼ë¡œ ìº¡í•‘
            service::create_edge(app_handle, document_id, doc_id,
                                Some("similar"), weight)?;
        }
    }
}
```

**íš¨ê³¼**:
```
ì˜ˆ: A ë¬¸ì„œì™€ B ë¬¸ì„œì˜ ìœ ì‚¬ì„±
- ìœ ì‚¬í•œ ë¸”ë¡ì´ 1ê°œ: weight = 1/10 = 0.1 (ì•½í•œ ì—°ê²°)
- ìœ ì‚¬í•œ ë¸”ë¡ì´ 5ê°œ: weight = 5/10 = 0.5 (ì¤‘ê°„ ì—°ê²°)
- ìœ ì‚¬í•œ ë¸”ë¡ì´ 10ê°œ+: weight = 1.0 (ê°•í•œ ì—°ê²°)

â†’ ì—°ê²° ê°•ë„ê°€ ì˜ë¯¸ë¡ ì  ìœ ì‚¬ì„±ì„ ë°˜ì˜
â†’ ì‚¬ìš©ìëŠ” ë” ê´€ë ¨ ê¹Šì€ ë…¸íŠ¸ë¶€í„° ë³´ê²Œ ë¨
```

---

### 2.5 ğŸŸ¡ **Vector Update ì¶”ì  ë¶€ì¡±** (ì‹¬ê°ë„: ë‚®ìŒ-ì¤‘ê°„)

**í˜„ì¬ êµ¬í˜„** (repository.rs:177-205):
```rust
pub fn upsert_block(...) {
    // contentê°€ ë³€ê²½ë˜ë©´ indexing_statusë¥¼ 0ìœ¼ë¡œ ë¦¬ì…‹
    // í•˜ì§€ë§Œ ìœ ì‚¬ë„ ë³€í™”ë¥¼ ì¶”ì í•˜ì§€ ì•ŠìŒ
}
```

**ë¬¸ì œì :**
1. **ìœ ì‚¬ë„ ë³€í™” ë¯¸ì¶”ì **:
   - ë¸”ë¡ ìˆ˜ì • â†’ embedding ì¬ê³„ì‚°
   - í•˜ì§€ë§Œ "ì–´ë–¤ ê´€ê³„ê°€ ê¹¨ì¡Œë‚˜", "ìƒˆë¡œìš´ ê´€ê³„ê°€ ìƒê²¼ë‚˜" ëª¨ë¦„

2. **ì—…ë°ì´íŠ¸ ì´ë ¥ ë¶€ì¬**:
   - ë²„ì „ ê´€ë¦¬ ì—†ìŒ
   - ë¡¤ë°± ë¶ˆê°€ëŠ¥

---

### 2.6 ğŸŸ¡ **ë‹¤ì¤‘ í™‰ ê²€ìƒ‰ ì—†ìŒ** (ì‹¬ê°ë„: ë‚®ìŒ)

**í˜„ì¬**: ì§ì ‘ ìœ ì‚¬ë„ë¡œë§Œ ì—°ê²°
```
A â†’ B â†’ Cì˜ ê²½ë¡œë¥¼ í™œìš©í•˜ì§€ ì•ŠìŒ
PageRankë‚˜ ë‹¤ì¤‘ í™‰ ê²€ìƒ‰ìœ¼ë¡œ ê°„ì ‘ ê´€ë ¨ì„± í™œìš© ê°€ëŠ¥
```

---

## 3ï¸âƒ£ RAG íŒŒì´í”„ë¼ì¸ í‰ê°€

### RAG 4-Step ì²´í¬ë¦¬ìŠ¤íŠ¸

| ë‹¨ê³„ | êµ¬í˜„ | í‰ê°€ | ì„¤ëª… |
|------|------|------|------|
| **1. Chunking** | âœ… | ìš°ìˆ˜ | ë¸”ë¡ ë‹¨ìœ„ë¡œ ìë™ ì²­í‚¹ |
| **2. Embedding** | âš ï¸ | ë‚®ìŒ | ë¬¸ì í•´ì‹œ ê¸°ë°˜ (ì˜ë¯¸ë¡ ì  ì•„ë‹˜) |
| **3. Storage** | âœ… | ìš°ìˆ˜ | SQLite-vec ì ì ˆ |
| **4. Retrieval** | âš ï¸ | ì¤‘ê°„ | ê±°ë¦¬ ê¸°ë°˜ë§Œ (relevance rank ì—†ìŒ) |
| **5. Ranking** | âŒ | ì—†ìŒ | ìœ ì‚¬ë„ ê±°ë¦¬ë§Œìœ¼ë¡œ ì •ë ¬ |
| **6. Generation** | âŒ | êµ¬í˜„ ì•ˆ ë¨ | LLM í†µí•© ê³„íš? |

**ì¢…í•©**: RAGì˜ "Retrieval" ë‹¨ê³„ë§Œ êµ¬í˜„ë˜ì–´ ìˆìŒ

---

## 4ï¸âƒ£ ì„±ëŠ¥ ë° í™•ì¥ì„±

### 4.1 ì‹œê°„ ë³µì¡ë„ ë¶„ì„

```rust
// find_similar_blocks_with_document (repository.rs:272-291)
fn find_similar_blocks_with_document(
    embedding: &[f32],      // 384ì°¨ì›
    threshold: f32,
    limit: i64              // 100
) -> Vec<(String, String, f32)>
```

- SQLite-vecì˜ ANN ì„±ëŠ¥: O(log n) ~ O(sqrt(n))
- ê° ë¸”ë¡ ì—…ë°ì´íŠ¸ ì‹œ: O(log m) (m = ë²¡í„° ê°œìˆ˜)
- **í™•ì¥ì„±**: ë¸”ë¡ì´ 1Mê°œ ì´ìƒì´ë©´ ì¿¼ë¦¬ ì‹œê°„ì´ ì¦ê°€í•  ìˆ˜ ìˆìŒ

### 4.2 ë©”ëª¨ë¦¬ ì‚¬ìš©

```
384ì°¨ì› Ã— 4ë°”ì´íŠ¸(float32) Ã— 1M ë¸”ë¡ = ~1.5GB
ë°ìŠ¤í¬í†± ì•±ìœ¼ë¡œëŠ” ê´€ë¦¬ ê°€ëŠ¥
```

---

## 5ï¸âƒ£ ì ìš©ëœ ê°œì„ ì‚¬í•­ âœ…

### ì™„ë£Œ (Phase 1)

| í•­ëª© | ìƒíƒœ | íš¨ê³¼ |
|------|------|------|
| **2.1 Embedding í’ˆì§ˆ** | âœ… ì™„ë£Œ | ë‹¨ì–´ ê¸°ë°˜ TF ì„ë² ë”©ìœ¼ë¡œ ì˜ë¯¸ë¡ ì  í¬ì°© ê°œì„  |
| **2.2 ì–‘ë°©í–¥ ê·¸ë˜í”„** | âœ… ì™„ë£Œ | DB ë ˆë²¨ ì–‘ë°©í–¥ ì¡°íšŒë¡œ ë°ì´í„° íš¨ìœ¨ì„± ìœ ì§€ |
| **2.4 Edge ê°€ì¤‘ì¹˜** | âœ… ì™„ë£Œ | ìœ ì‚¬ ë¸”ë¡ ê°œìˆ˜ ê¸°ë°˜ ê°€ì¤‘ì¹˜ë¡œ ê´€ë ¨ì„± ë°˜ì˜ |

**êµ¬í˜„ íŒŒì¼:**
- `src-tauri/src/domains/document/scheduler.rs`: TF-IDF ì„ë² ë”©, ê°€ì¤‘ì¹˜ ê³„ì‚°
- `src-tauri/src/domains/document/repository.rs`: ì–‘ë°©í–¥ ì¿¼ë¦¬
- `src-tauri/src/domains/document/service.rs`: ê´€ë ¨ í•¨ìˆ˜ ì¶”ê°€

---

## 6ï¸âƒ£ ì¶”í›„ ê°œì„ ì‚¬í•­ (ìš°ì„ ìˆœìœ„)

### ğŸŸ  **P2: ë™ì  Configuration** (ì˜í–¥ë ¥: ì¤‘)

**ì¶”ê°€í•  ê²ƒ:**

1. **Config í…Œì´ë¸”**:
```sql
CREATE TABLE IF NOT EXISTS rag_config (
    key TEXT PRIMARY KEY,
    value REAL,
    description TEXT
)
```

2. **UI ì„¤ì • íŒ¨ë„**:
```
- Similarity Threshold: 0.0 ~ 1.0 (ê¸°ë³¸ 0.5)
- Search Limit: 10 ~ 1000 (ê¸°ë³¸ 100)
- Embedding Strategy: "hash", "tfidf", "ml"
```

**êµ¬í˜„ ë‚œì´ë„**: ì¤‘
**ì˜í–¥ë„**: ì¤‘

---

### ğŸŸ¡ **P3: Document-level Embedding** (ì˜í–¥ë ¥: ì¤‘)

```rust
pub struct Document {
    id: String,
    // ...
    document_embedding: Option<Vec<f32>>,  // ìƒˆë¡œ ì¶”ê°€
    blocks: Vec<Block>,
}

// ë¬¸ì„œ ì €ì¥ ì‹œ ë¸”ë¡ë“¤ì˜ embedding í‰ê· ìœ¼ë¡œ document embedding ìƒì„±
fn create_document_embedding(blocks: &[Block]) -> Vec<f32> {
    let mut doc_emb = vec![0.0; EMBEDDING_DIMENSION];

    for block in blocks {
        for (i, val) in block.embedding.iter().enumerate() {
            doc_emb[i] += val;
        }
    }

    for val in &mut doc_emb {
        *val /= blocks.len() as f32;
    }

    normalize(doc_emb)
}
```

**êµ¬í˜„ ë‚œì´ë„**: ë‚®ìŒ-ì¤‘
**ì˜í–¥ë„**: ì¤‘

---

### ğŸŸ¡ **P4: Multi-hop Retrieval** (ì˜í–¥ë ¥: ë‚®ìŒ)

```rust
fn find_related_documents_multihop(
    app_handle: &AppHandle,
    start_doc_id: &str,
    hops: usize,
) -> Result<Vec<(String, usize)>> {
    // BFSë¡œ ìµœëŒ€ `hops`ê°œì˜ ê±°ë¦¬ê¹Œì§€ íƒìƒ‰
    // ê±°ë¦¬ì™€ í•¨ê»˜ ë°˜í™˜
}
```

**êµ¬í˜„ ë‚œì´ë„**: ì¤‘
**ì˜í–¥ë„**: ë‚®ìŒ (advanced feature)

---

## 7ï¸âƒ£ êµ¬í˜„ ë¡œë“œë§µ

### Phase 1: ì™„ë£Œ âœ…
- [x] P0: TF-IDF ê¸°ë°˜ Embedding ê°œì„ 
- [x] P1: ì–‘ë°©í–¥ Edge ì¡°íšŒ (DB ë ˆë²¨)
- [x] P4: Edge ê°€ì¤‘ì¹˜ (ë¸”ë¡ ê°œìˆ˜ ê¸°ë°˜)

### Phase 2: ê³„íš ì¤‘ (ì˜ˆì •)
- [ ] P2: ë™ì  Configuration UI
  - Similarity Threshold ì¡°ì •
  - Search Limit ì¡°ì •
  - ë©€í‹°í™‰ ê²€ìƒ‰ ë ˆë²¨ ì„¤ì •
- [ ] P3: Document-level Embedding

### Phase 3: ê³ ë ¤ ì‚¬í•­
- [ ] ML ëª¨ë¸ ê¸°ë°˜ Embedding (ONNX) - ì„ íƒì‚¬í•­
- [ ] P5: ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ Learning
- [ ] LLM í†µí•© (Generation íŒŒì´í”„ë¼ì¸)

---

### 8.1 LLM í†µí•© ê³ ë ¤
í˜„ì¬ëŠ” Vector Searchë§Œ êµ¬í˜„ë˜ì–´ ìˆê³ , "Generation" ë¶€ë¶„ì´ ì—†ìŠµë‹ˆë‹¤.
```
ê²€ìƒ‰ëœ ë¬¸ì„œë“¤ â†’ LLM â†’ ìµœì¢… ë‹µë³€
```
í–¥í›„ ì¶”ê°€ ì˜ˆì •ì…ë‹ˆë‹¤.

### 8.2 ì‚¬ìš©ì í”¼ë“œë°± í™œìš© (Future)
```sql
CREATE TABLE feedback (
    query TEXT,
    retrieved_doc_id TEXT,
    user_rating INT,  -- 1: not relevant, 5: highly relevant
    created_at DATETIME
)
```
ì´ë¥¼ í†µí•´ Threshold ìë™ ì¡°ì •ì´ë‚˜ ëª¨ë¸ ì¬í•™ìŠµ ê°€ëŠ¥í•©ë‹ˆë‹¤.

### 8.3 ì¬ìƒ‰ì¸ ì „ëµ (Future)
```rust
// ì£¼ê¸°ì ìœ¼ë¡œ embedding í’ˆì§ˆ ì¬í‰ê°€
fn reindex_with_new_algorithm() {
    // ê¸°ì¡´ embedding ë²„ì „ ìœ ì§€
    // ìƒˆ ì•Œê³ ë¦¬ì¦˜ìœ¼ë¡œ ìƒˆë¡œ ìƒì„±
    // A/B í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
}
```

---

## ğŸ“Š í‰ê°€ ë³€í™”

| í•­ëª© | ê°œì„  ì „ | ê°œì„  í›„ | ìƒíƒœ |
|------|--------|--------|------|
| **Embedding í’ˆì§ˆ** | 2/5 | 4/5 | âœ… ì™„ë£Œ |
| **Graph ì—°ê²°ì„±** | 3/5 | 5/5 | âœ… ì™„ë£Œ |
| **Edge ê°€ì¤‘ì¹˜** | 1/5 | 4/5 | âœ… ì™„ë£Œ |
| **Configuration** | 1/5 | 1/5 | ì˜ˆì • |
| **Document Context** | 2/5 | 2/5 | ì˜ˆì • |
| **Multi-hop** | 0/5 | 0/5 | ì„ íƒì‚¬í•­ |
| **ì „ì²´ RAG ì™„ì„±ë„** | **3.5/5** | **4.0/5** | âœ… ê°œì„ ë¨ |

---

## ğŸ¯ ìµœì¢… ìƒíƒœ

**âœ… Phase 1 ì™„ë£Œ**
- TF-IDF ê¸°ë°˜ Embeddingìœ¼ë¡œ ë‹¨ì–´ ë¹ˆë„ ë°˜ì˜
- DB ë ˆë²¨ ì–‘ë°©í–¥ ê·¸ë˜í”„ ì¡°íšŒ
- ìœ ì‚¬ ë¸”ë¡ ê°œìˆ˜ ê¸°ë°˜ Edge ê°€ì¤‘ì¹˜

**ğŸ“‹ ë‹¤ìŒ ë‹¨ê³„**
1. P2: Configuration UI (ì˜ˆ: ì„ê³„ê°’, ê²€ìƒ‰ ë²”ìœ„ ì¡°ì •)
2. P3: Document-level Embedding (ë¬¸ì„œ ì „ì²´ ì»¨í…ìŠ¤íŠ¸)
3. P5: ì‚¬ìš©ì í”¼ë“œë°± ê¸°ë°˜ Learning (ì„ íƒì‚¬í•­)
